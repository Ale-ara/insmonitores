<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>L2ro • Galeria de Prints</title>

<style>
:root{
  --ins:#0059a7;--fundo:#0a0a0f;--texto:#f4f4f4
}
body{margin:0;font-family:'Poppins',sans-serif;background:var(--fundo);color:var(--texto);overflow:hidden}
html,body{cursor:none}

.custom-cursor{
  position:fixed;top:0;left:0;width:32px;height:32px;pointer-events:none;
  transform:translate(-50%,-50%);z-index:9999
}
.custom-cursor img{width:100%;height:100%}

/* LOADING */
#loading{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:#000;display:flex;justify-content:center;align-items:center;z-index:999999;
  color:white;font-size:22px;font-weight:700;
}
#loading::after{
  content:"";width:26px;height:26px;border:4px solid #fff;
  border-top-color:transparent;border-radius:50%;margin-left:12px;
  animation:spin 0.8s linear infinite;
}
@keyframes spin{
  from{transform:rotate(0deg)}
  to{transform:rotate(360deg)}
}

/* APP */
.app {display:flex;flex-direction:column;height:100vh;width:100vw;}
.header{display:flex;align-items:center;gap:12px;padding:16px 22px;
background:linear-gradient(90deg,var(--ins) 20%, rgba(16,22,98,0.7) 100%);z-index:2;}
.logo {width:56px}

.main {flex:1;display:flex;gap:18px;padding:22px;overflow:auto}
.left {flex:1;min-width:320px}
.grid {display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:18px}

.pasta {
  background:rgba(255,255,255,0.03);padding:18px;border-radius:12px;text-align:center;
  cursor:pointer;border:1px solid rgba(255,255,255,0.02);transition:.18s;
}
.pasta:hover{transform:translateY(-6px);box-shadow:0 18px 60px rgba(0,0,0,0.5)}
.pasta img{width:68px}

.right {
  width:520px;max-width:44%;min-width:320px;background:rgba(255,255,255,0.03);
  padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.02);
  height:calc(100vh - 120px);overflow:auto
}

.preview img {
  max-width:100%;max-height:60vh;border-radius:8px;object-fit:contain;
  box-shadow:0 18px 60px rgba(0,0,0,0.6)
}

.lista-prints{display:flex;flex-wrap:wrap;gap:10px}
.thumb{
  width:120px;background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;
  cursor:pointer;text-align:center
}
.thumb img{width:100%;height:70px;border-radius:6px;object-fit:cover}

.panel-bottom{
  position:fixed;left:18px;bottom:18px;display:flex;gap:8px;z-index:9999;
}
.panel-card{
  background:#fff;color:#000;padding:6px;border-radius:10px;
  display:flex;gap:6px;align-items:center;
}
.panel-card img{width:48px;height:48px;border-radius:8px}

.voltar{
  position:fixed;right:18px;bottom:18px;background:var(--ins);color:#fff;
  padding:12px;border-radius:10px;cursor:pointer
}
</style>
</head>

<body>

<div id="loading">Carregando</div>

<div class="custom-cursor">
  <img src="https://www.habbo.com.br/habbo-imaging/badge/b09064s43131s50134s17113s171153f3edc7f555be912c2392e285b05bd34.gif">
</div>

<div class="app">

<header class="header">
  <img class="logo" src="https://i.imgur.com/2HJ0aLw.png">
  <div>
    <div style="font-weight:700">Aulas monitoradas pelo L2ro</div>
    <div style="font-size:12px;color:#dfeaff">Clique no instrutor e veja as aplicações</div>
  </div>
</header>

<div class="main">
  <div class="left">
    <h2>Instrutores</h2>
    <div class="grid" id="gridInstrutores"></div>
  </div>

  <div class="right">
    <div id="emptyMsg" style="color:#cfd9ff">Selecione um instrutor</div>

    <div id="viewArea" style="display:none">
      <div class="preview">
        <img id="largeImg">
        <div>
          <h3 id="metaTitle"></h3>
          <div id="metaSub" style="color:#cfd9ff"></div>
        </div>
      </div>

      <hr>

      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong>Prints</strong>
        <div id="countPrints"></div>
      </div>

      <div class="lista-prints" id="listaPrints"></div>
    </div>
  </div>
</div>

<button class="voltar" onclick="location.reload()">⤺ Reiniciar</button>
<div class="panel-bottom" id="panelBottom" style="display:none"></div>

</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzY__6eJvLpaw7ahmaRNuQoIYSpfv_SOjOsZvDpz1EfjOg8wqBG1vG9My2qfnxFril9/exec";

function el(t,c){const d=document.createElement(t);if(c)d.className=c;return d;}
function escapeHtml(s){return s? s.replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])):"";}

const grid=document.getElementById("gridInstrutores");
const emptyMsg=document.getElementById("emptyMsg");
const viewArea=document.getElementById("viewArea");
const listaPrints=document.getElementById("listaPrints");
const largeImg=document.getElementById("largeImg");
const metaTitle=document.getElementById("metaTitle");
const metaSub=document.getElementById("metaSub");
const countPrints=document.getElementById("countPrints");
const panelBottom=document.getElementById("panelBottom");

let DATA=[];

document.addEventListener("mousemove",e=>{
  document.querySelector(".custom-cursor").style.transform=`translate(${e.clientX}px,${e.clientY}px)`
});

fetch(API_URL)
  .then(r=>r.json())
  .then(json=>{
    DATA=json;
    renderInstrutores(json);
    document.getElementById("loading").style.display="none";
  });

function renderInstrutores(list){
  grid.innerHTML="";
  list.forEach(inst=>{
    const card=el("div","pasta");
    card.innerHTML=`
      <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png">
      <h3>${escapeHtml(inst.instrutor)}</h3>
      <div style="font-size:12px;color:#cfd9ff">${inst.aplicacoes.length} aplicações</div>`;
    card.onclick=()=>abrirInstrutor(inst);
    grid.appendChild(card);
  });
}

function abrirInstrutor(inst){
  emptyMsg.style.display="none";
  viewArea.style.display="block";
  listaPrints.innerHTML="";

  let printsFlatten=[];
  inst.aplicacoes.forEach(app=>{
    app.prints.forEach(p=>{
      printsFlatten.push({
        print:p,
        alunos:app.alunos.join(", "),
        data:app.data
      });
    });
  });

  if(printsFlatten.length>0) mostrarPrint(printsFlatten[0]);

  printsFlatten.forEach(p=>{
    const card=el("div","thumb");
    card.innerHTML=`
      <img src="${p.print}">
      <small>${escapeHtml(p.alunos)}</small>
    `;
    card.onclick=()=>mostrarPrint(p);
    listaPrints.appendChild(card);
  });

  countPrints.innerText=printsFlatten.length+" prints";

  renderPanel(inst);
}

function mostrarPrint(item){
  largeImg.src=item.print;
  metaTitle.innerText=item.alunos;
  metaSub.innerText="Data: "+item.data;
}

function renderPanel(inst){
  panelBottom.innerHTML="";
  panelBottom.style.display="flex";

  const card=el("div","panel-card");
  card.innerHTML=`
    <img src="${inst.personagemInstrutor}">
    <div><div class="nome">${inst.instrutor}</div><div class="tipo">Instrutor</div></div>`;
  panelBottom.appendChild(card);
}
</script>

</body>
</html>
